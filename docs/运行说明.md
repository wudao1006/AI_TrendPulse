# AI Public Opinion - å®Œæ•´è¿è¡Œä¸éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—æ—¨åœ¨å¸®åŠ©æ‚¨ä»é›¶å¼€å§‹æ­å»ºå¹¶è¿è¡Œ **AI Public Opinion** ç³»ç»Ÿã€‚è¯·ä¸¥æ ¼æŒ‰ç…§æ­¥éª¤æ“ä½œã€‚

---

## ğŸ›  ç¬¬ä¸€éƒ¨åˆ†ï¼šç¯å¢ƒé¢„æ£€

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æœºå™¨å·²å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š
*   **Python 3.10+**: [ä¸‹è½½åœ°å€](https://www.python.org/)
*   **Flutter SDK 3.16+**: [ä¸‹è½½åœ°å€](https://docs.flutter.dev/get-started/install)
*   **PostgreSQL 14+**: æ ¸å¿ƒæ•°æ®åº“ã€‚
*   **Redis 6.0+**: ä»»åŠ¡é˜Ÿåˆ—ä¸­é—´ä»¶ã€‚
*   **Google Chrome**: ç”¨äº X (Twitter) é‡‡é›†å™¨è¿è¡Œã€‚

---

## ğŸ”‘ ç¬¬äºŒéƒ¨åˆ†ï¼šè·å–å…³é”®å‡­è¯ (Credentials)

ç³»ç»Ÿè¿è¡Œé«˜åº¦ä¾èµ–ç¬¬ä¸‰æ–¹ APIï¼Œè¯·æå‰å‡†å¤‡ï¼š

### 1. LLM API (å¿…é€‰)
*   **æ¨è**: OpenAI, DeepSeek æˆ– Claudeã€‚
*   **æ“ä½œ**: è·å– API Key å’Œ Base URLã€‚
*   **é…ç½®é¡¹**: `LLM_API_KEY`, `LLM_API_BASE_URL`

### 2. YouTube API (å¯é€‰ï¼Œä¸é…ç½®åˆ™æ— æ³•é‡‡é›† YouTube)
*   **æ“ä½œ**: 
    1. å‰å¾€ [Google Cloud Console](https://console.cloud.google.com/)ã€‚
    2. åˆ›å»ºé¡¹ç›®å¹¶å¯ç”¨ **YouTube Data API v3**ã€‚
    3. åœ¨â€œå‡­æ®â€é¡µé¢åˆ›å»º API å¯†é’¥ã€‚
*   **é…ç½®é¡¹**: `YOUTUBE_API_KEY`

### 3. Reddit API (å¯é€‰)
*   **æ“ä½œ**: å‰å¾€ [Reddit App Console](https://www.reddit.com/prefs/apps) åˆ›å»ºä¸€ä¸ª `script` ç±»å‹çš„åº”ç”¨ã€‚
*   **é…ç½®é¡¹**: `REDDIT_CLIENT_ID`, `REDDIT_CLIENT_SECRET`

### 4. X (Twitter) Cookie (æ ¸å¿ƒéš¾ç‚¹)
ç”±äº X å¹³å°æ²¡æœ‰å…è´¹ APIï¼Œç³»ç»Ÿä½¿ç”¨çˆ¬è™«æ¨¡å¼ã€‚
*   **è·å–æ–¹æ³•**:
    1. åœ¨ Chrome æµè§ˆå™¨ç™»å½• X è´¦å·ã€‚
    2. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåˆ‡æ¢åˆ° `Network` é€‰é¡¹å¡ã€‚
    3. åˆ·æ–°é¡µé¢ï¼Œæ‰¾åˆ°ä»»æ„ä¸€ä¸ªè¯·æ±‚ï¼ŒæŸ¥çœ‹ `Request Headers`ã€‚
    4. å¤åˆ¶å…¶ä¸­çš„ `cookie` å­—ç¬¦ä¸²ã€‚
*   **é…ç½®é¡¹**: å¡«å…¥ `X_ACCOUNTS_JSON` æˆ–æ”¾åœ¨ `backend/X.json`ã€‚

---

## ğŸ— ç¬¬ä¸‰éƒ¨åˆ†ï¼šåç«¯éƒ¨ç½²

### 1. åˆå§‹åŒ– Python ç¯å¢ƒ
```bash
cd backend
python -m venv venv
# Windows
.\venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

pip install -r requirements.txt
playwright install chromium
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
ä¿®æ”¹ `.env` æ–‡ä»¶ï¼š
```ini
# æ•°æ®åº“ä¸ä¸­é—´ä»¶
DATABASE_URL=postgresql://postgres:ä½ çš„å¯†ç @localhost:5432/ai_sentiment
REDIS_URL=redis://localhost:6379/0

# API é‰´æƒ (è‡ªå®šä¹‰ï¼Œå‰ç«¯è¯·æ±‚æ—¶éœ€æºå¸¦)
API_KEY=ai_sentiment_secret_2026

# AI é…ç½®
LLM_API_KEY=sk-xxxx
LLM_API_BASE_URL=https://api.openai.com/v1
LLM_MODEL=gpt-4-turbo

# é‡‡é›†é…ç½® (å¡«å…¥ä½ è·å–çš„ Key)
YOUTUBE_API_KEY=AIza...
X_ACCOUNTS_JSON='[{"id":"user1","cookies_header":"..."}]'
```

### 3. æ•°æ®åº“è¿ç§»
```bash
alembic upgrade head
```

### 4. å¯åŠ¨åç«¯æœåŠ¡ (éœ€è¦å¼€å¯ä¸¤ä¸ªç»ˆç«¯)

**ç»ˆç«¯ A: API æœåŠ¡**
```bash
uvicorn app.main:app --reload
```

**ç»ˆç«¯ B: Celery Worker (è®¡ç®—æ ¸å¿ƒ)**
```bash
# Windows (å¿…é¡»åŠ  -P solo)
celery -A app.workers.celery_app worker --loglevel=info -P solo

# Linux/Mac
celery -A app.workers.celery_app worker --loglevel=info
```

---

## ğŸ“± ç¬¬å››éƒ¨åˆ†ï¼šå‰ç«¯éƒ¨ç½²

### 1. é…ç½® API é‰´æƒ (æ¨èæ–¹å¼)
ç”±äºåç«¯å¼€å¯äº†å®‰å…¨é‰´æƒï¼Œæ‚¨å¿…é¡»åœ¨å¯åŠ¨å‰ç«¯æ—¶æ³¨å…¥å¯¹åº”çš„ API Keyã€‚å‰ç«¯ `ApiService` ä¼šè‡ªåŠ¨å°†å…¶æ”¾å…¥ `Authorization: Bearer <key>` å¤´éƒ¨ã€‚ç³»ç»Ÿæ”¯æŒé€šè¿‡ Flutter çš„ `--dart-define` å‘½ä»¤è¡Œå‚æ•°åŠ¨æ€æ³¨å…¥é…ç½®ï¼Œæ— éœ€ä¿®æ”¹æºä»£ç ã€‚

### 2. è¿è¡Œå‰ç«¯
è¯·å°† `ä½ çš„APIå¯†é’¥` æ›¿æ¢ä¸º `backend/.env` ä¸­ `API_KEY` çš„å€¼ã€‚

**è¿è¡Œ Web ç«¯:**
```bash
cd frontend
flutter pub get
flutter run -d chrome --web-renderer html \
  --dart-define=API_KEY=ä½ çš„APIå¯†é’¥ \
  --dart-define=API_BASE_URL=http://localhost:8000/api/v1
```

**è¿è¡Œ Windows ç«¯:**
```bash
cd frontend
flutter run -d windows \
  --dart-define=API_KEY=ä½ çš„APIå¯†é’¥ \
  --dart-define=API_BASE_URL=http://localhost:8000/api/v1
```

> **æç¤º**: å¦‚æœæ‚¨é¢‘ç¹è¿è¡Œï¼Œå¯ä»¥åœ¨ IDE (VS Code / Android Studio) çš„å¯åŠ¨é…ç½® (Launch Configuration) ä¸­æ·»åŠ è¿™äº› `--dart-define` å‚æ•°ï¼Œé¿å…æ¯æ¬¡æ‰‹åŠ¨è¾“å…¥ã€‚

---

## â“ ç¬¬äº”éƒ¨åˆ†ï¼šå¸¸è§é—®é¢˜å¤„ç† (FAQ)

### 1. ä»»åŠ¡ä¸€ç›´å¡åœ¨ "Running" æˆ– "Progress 0%"
*   **æ£€æŸ¥**: Celery Worker æ˜¯å¦å¯åŠ¨ï¼ŸæŸ¥çœ‹ Worker ç»ˆç«¯æ˜¯å¦æœ‰æŠ¥é”™ä¿¡æ¯ã€‚
*   **æ£€æŸ¥**: Redis æ˜¯å¦æ­£å¸¸è¿æ¥ï¼Ÿ

### 2. X é‡‡é›†æŠ¥é”™ "Login failed or cookies expired"
*   **åŸå› **: X å¹³å°çš„ Cookie å…·æœ‰æ—¶æ•ˆæ€§æˆ–è´¦å·è¢«é£æ§ã€‚
*   **è§£å†³**: æŒ‰ç…§ç¬¬äºŒéƒ¨åˆ†é‡æ–°è·å– Cookie å­—ç¬¦ä¸²ï¼Œå¹¶ç¡®ä¿ç½‘ç»œç¯å¢ƒï¼ˆä»£ç†ï¼‰ç¨³å®šã€‚

### 3. è¯­ä¹‰åˆ†ææŠ¥é”™ "Module not found: sentence_transformers"
*   **è§£å†³**: ç¡®ä¿åœ¨åç«¯è™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œäº† `pip install -r requirements.txt`ã€‚é¦–æ¬¡è¿è¡Œä¼šä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼ˆçº¦ 100MBï¼‰ï¼Œè¯·ä¿æŒç½‘ç»œç•…é€šã€‚

### 4. Windows ä¸‹ Celery ä¸æ‰§è¡Œä»»åŠ¡
*   **åŸå› **: Celery åŸç”Ÿå¯¹ Windows æ”¯æŒä¸ä½³ã€‚
*   **è§£å†³**: å¯åŠ¨å‘½ä»¤å¿…é¡»åŒ…å« `-P solo` æˆ– `-P eventlet`ã€‚

---

## ğŸ’¡ è¿›é˜¶ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®
1.  **è¿›ç¨‹ç®¡ç†**: ä½¿ç”¨ `Supervisor` æˆ– `PM2` ç®¡ç† FastAPI å’Œ Celery è¿›ç¨‹ï¼Œé˜²æ­¢å´©æºƒã€‚
2.  **å®‰å…¨éš”ç¦»**: ä¸è¦å°† `.env` æäº¤åˆ° Gitã€‚
3.  **è´Ÿè½½å‡è¡¡**: ä½¿ç”¨ Nginx è½¬å‘ FastAPI çš„ç«¯å£ (8000)ã€‚
